# 矩阵和线性代数

[TOC]



## 概要

线性方程组的解、矩阵方程的解、矩阵可逆、矩阵的秩、行列式之间的关系

符号：

- $detA$ 计算方阵A的行列式（是一个数值）
- $adjA$ 矩阵A的伴随矩阵

## 线性方程组

### 基本概念

**线性方程**：包含变量 $x_{1},x_{2},...,x_{n}$ ，形如 $a_{1}x_{1}+a_{2}x_{2}+...+a_{n}x_{n}=b$ 的方程（多元一次方程）。

**线性方程组**：多个线程方程组成的方程组（多元一次方程组），如下：



$$
\left\{\begin{array}{l}   
5x_{1} - 6x_{2} + 2x_{3} = 2
\\ 2x_{1} + x_{2} + 3x_{3} = 1
\\ x_{1} - 0x_{2} + x_{3} = 1
\end{array}\right.
$$

**系数矩阵**：方程组的系数组成的矩阵，如下：


$$
\begin{bmatrix}
5 & -6 & 2\\ 
2 & 1 & 3\\ 
1 & 0 & 1
\end{bmatrix}
$$



**增广矩阵**：系数矩阵后增加一列 $b$ 形成的矩阵，如下：


$$
\begin{bmatrix}
5 & -6 & 2 &2\\ 
2 & 1 & 3 &1\\ 
1 & 0 & 1 &1
\end{bmatrix}
$$



两个方程组的增广矩阵若是等价的，则他们的解相同。（通过3种行变换能够转换的）

**方程组等价**：两个线性方程组有相同的解集，称两个线性方程组是等价的（或增广矩阵是行等价的）

**方程组的解**：

- 无解：
- 唯一解：
- 无穷多个解

其中：有解叫相容；无解叫不相容。

**线性方程组的解法**：把线性方程组化为更容易求解的等价方程组（三角形）。对增广矩阵进行初等行变换，初等行变换三种有：

- 倍加变换：把某一行变成它本身和另一行的倍数的和
- 对换变换：把两行对换
- 倍乘变换：把某一行的所有元素乘以同一个非零数

```tip
**注意：**{:.h3}

1. 任何矩阵做行变换得到的矩阵，是和原矩阵等价的（所有矩阵）
2. 行变换可逆
3. 若两个线性方程组的增广矩阵是等价的，则他们具有相同的解集
```

### 线性方程组的求解例题

**唯一解例题**

方程组为：



$$
\left\{\begin{array}{l}    5x_{1} - 6x_{2} + 2x_{3} = 2
\\ 2x_{1} + x_{2} + 3x_{3} = 1
\\ x_{1} - 0x_{2} + x_{3} = 1
\end{array}\right.
$$


增广矩阵行变换如下：

$$
\begin{bmatrix}
5 & -6 & 2 &2\\ 
2 & 1 & 3 &1\\ 
1 & 0 & 1 &1
\end{bmatrix}       
=
\begin{bmatrix}
1 & 0 & 1 &1\\ 
0 & 1 & 1 &-1\\ 
0 & 0 & 3 &3
\end{bmatrix}
$$

`=`表示经过行变换后的等价矩阵（三角形），则变换后的等价方程如下：

$$
\left\{\begin{array}{l}  x_{1} - 0x_{2} + x_{3} = 1
\\ 0x_{1} + x_{2} + x_{3} = -1
\\ 0x_{1} - 0x_{2} + 3x_{3} = 3
\end{array}\right.
$$



则方程组的解唯一，解为：


$$
\left\{\begin{array}{l}  x_{1} = 0
\\ x_{2} = -2
\\ x_{3} = 1
\end{array}\right.
$$

该系数矩阵满秩，方程组解唯一

**无穷解例题**

若某个方程组的增广矩阵行变换最终为：


$$
\begin{bmatrix}
1 & 0 & -5 &1\\ 
0 & 1 & 1 &-1\\ 
0 & 0 & 0 &0
\end{bmatrix}
$$

则方程组的解有无穷多个。其中 $x_{1}，x_{2}$ 称为**基本变量**，$x_{3}$ 为**自由变量**（也可以取 $x_{1}，x_{3}$ 为基本变量， $x_{2}$ 为自由变量）。

**基本变量与自由变量**：在三角形/阶梯型中，数阶梯数目，若同一级阶梯只有一列，这列就是**基本变量**（这里的第一列就是，即$x_{1}$）。若有多列（第二级阶梯有两列，第二列和第三列），则在多列中只取一列，做**基本变量**（若取第二列就是$x_{2}$），剩下的其他列做**自由变量**（剩下第三列就是$x_{3}$），与原方程等价的方程如下：



$$
\left\{\begin{array}{l}    
x_{1}\quad\quad  - 5x_{3} = 1
\\ \quad\quad x_{2} + x_{3} = -1
\\ \quad\quad\quad\quad\quad  0=0
\end{array}\right.
$$



这里取 $x_{1}，x_{2}$ 基本变量，$x_{3}$ 为自由变量。则解为：


$$
\left\{\begin{array}{l}   
x_{1} = 5x_{3}+1
\\ x_{2}=-x_{3}-1
\\ x_{3}是自由变量
\end{array}\right.
$$


自由变量是指他可以取任意值，当自由变量确定后，才能确定基本变量。自由变量取值不同，则解不同。

系数矩阵与增广矩阵相同，且不满秩，则解无穷（必有多列处于同一级阶梯中）

**无解例题**

方程组为：



$$
\left\{\begin{array}{l}   
\quad\quad\quad 2x_{2} - 4x_{3} = 8
\\ 2x_{1}-3x_{2} +2x_{3} = 1
\\ 4x_{1}-8x_{2} +12x_{3} = 1
\end{array}\right.
$$


增广矩阵行变换如下：

$$
\begin{bmatrix}
0 & 2 & -4 & 8 \\ 
2 & -3 & 2 & 1 \\ 
4 & -8 & 12 & 1 
\end{bmatrix}       
=
\begin{bmatrix}
2 & -3 & 2 &1\\ 
0 & 1 & -4 &8\\ 
0 & 0 & 0 &15
\end{bmatrix}
$$

则变换后的等价方程如下：


$$
\left\{\begin{array}{l}  
2x_{1} - 3x_{2} + 2x_{3} = 1
\\ \quad\quad\quad x_{2} -4x_{3} = 8
\\ \quad\quad\quad\quad\quad\quad0 = 15
\end{array}\right.
$$

则方程组无解（0不可能等于15）

系数矩阵不满秩，增广矩阵的秩为系数矩阵满秩数，则无解（增广矩阵秩比系数矩阵秩大）

### 矩阵方程

有线性方程组如下：


$$
\left\{\begin{array}{l}   
a_{11}x_{1}+a_{12}x_{2}+...+a_{1n}x_{n}=b_{1}
\\ a_{21}x_{1}+a_{22}x_{2}+...+a_{2n}x_{n}=b_{2}
\\ a_{31}x_{1}+a_{32}x_{2}+...+a_{3n}x_{n}=b_{3}
\\...
\\ a_{m1}x_{1}+a_{m2}x_{2}+...+a_{mn}x_{n}=b_{n}
\end{array}\right.
$$


可以写成矩阵的形式，如下：


$$
Ax=b
$$


其中，$A$ 为 $m\times n$ 记为 $A_{m\times n}$，他的各列为 $a_{1},a_{2},...,a_{n}$，而$a_{n} = [a_{11} \quad a_{21}\quad \quad ...\quad a_{m1}]^T$ ，其实$A$ 就是系数矩阵。$x$ 是$x_{n}$ 的列向量，$b$ 是$b_{n}$ 的列向量。



**齐次方程**：如果$b=0$，则称$Ax=0$ 为齐次方程。

把线性方程组转换为矩阵的形式，就可以通过矩阵的只是判断线性方程组的某些性质。

- 平凡解：全零解，即$x = 0$，其次线性方程组，必然有一个平凡解
- 非平凡解：不全为零的一组解

**增广矩阵**：$[a_{1} \quad a_{2}\quad a_{n}\quad b]$



### 线性无关

有一组向量$[x_{1} \quad x_{2} \quad ... \quad x_{n}]$，若向量方程$p_{1}x_{1} +p_{2}x_{2}+ ...+ p_{n}x_{n}=0$ :

- 仅有平凡解（全0解），则称$[x_{1} \quad x_{2} \quad ... \quad x_{n}]$ 是线性无关的（向量组中，任意两个向量均不等价，不能相互变换）
- 存在不全为0的解，则称$[x_{1} \quad x_{2} \quad ... \quad x_{n}]$ 是线性相关的（向量组中至少存在两个向量是可以相互等价转换的，即可以用一个表示另一个）

对于线性齐次方程$Ax=0$ 来说，一下三种说法是等价的：

- $A$ 的各列线性无关
- 只有平凡解
- A满秩
- A的行列式不等于0



## 行列式

行列式是一个数，最终要计算出一个数（可正、可负），不是矩阵。

只有行列数相同的矩阵（方阵），可以当作行列式计算结果。

```note
这不区分矩阵的中括号和行列式的竖线符号
```



### 行列式的计算

计算行列式的值，符号$det$

**二阶行列式的计算**

有二阶行列式如下：


$$
A=\begin{bmatrix}
a_{11} & a_{12}\\ 
a_{21} & a_{22}
\end{bmatrix}
$$


则计算公式为：$detA = a_{11}a_{22}-a_{21}a_{12}$ ，即：主对角线上的两个元素乘积 - 副对角线的元素乘积



**三阶行列式的计算**

有三阶行列式如下：


$$
A=\begin{bmatrix}
a_{11} & a_{12} & a_{13}\\ 
a_{21} & a_{22} & a_{23}\\
a_{31} & a_{32} & a_{33}
\end{bmatrix}
$$

则计算公式为：$detA = a_{11}a_{22}a_{33} + a_{12}a_{23}a_{31} + a_{13}a_{21}a_{32} - a_{11}a_{23}a_{32} - a_{12}a_{21}a_{33} - a_{31}a_{22}a_{13}$ ，计算公式类似与二阶的主对角线元素乘积，但是主对角线只有一条，类似$a_{12}a_{23}a_{31}$ 的乘积



**高阶行列式的计算**

高阶行列式计算结果，可按行/列展开，选择某一行，选择某行时，可以先进行行变换，变换出有0多的行，较方便，下面的公式是选择第一行。

高阶行列式，$n\geqslant 2$，n阶方阵$A=[a_{ij}]$ 的行列式是形如$\pm a_{1j}detA_{1j}$的n个项的和，其中加号和减号交替出现，元素$a_{11},a_{12}, ..., a_{1n}$来自A的第一行，表示为：$detA=a_{11}detA_{11} - a_{12}detA_{12} + ... + (-1)^{1+n}a_{1n}detA_{1n} = \sum_{j=1}^{n}(-1)^{1+j}a_{1j}detA_{1j}$

**子式**：任意选定k行与k列 (1≤k≤n)，位于这些行与列交点上的 $k^2$ 个元素按照原来相对位置构成的一个k阶行列式，称为A的一个k阶子式。例如一个3阶行列式，二阶子式，选两行两列，有9种，列举四种如下：（其实，从行来说，3行取两行，3种；从列来说，3列取两列，3种；所以共有9种）
$$
\begin{bmatrix}
a_{11} & a_{12}\\ 
a_{21} & a_{22}
\end{bmatrix}、\begin{bmatrix}
a_{12} & a_{13}\\ 
a_{22} & a_{23}
\end{bmatrix}、\begin{bmatrix}
a_{21} & a_{22}\\ 
a_{31} & a_{32}
\end{bmatrix}、\begin{bmatrix}
a_{22} & a_{23}\\ 
a_{32} & a_{33}
\end{bmatrix}
$$

**余子式**（余因式、余因子）：把所在的第i行与第j列划去后，所留下来的n-1阶行列式叫的余子式$A_{ij}$。$A_{11}$表示划去第一行第一列，如下：
$$
A_{11}=\begin{bmatrix}
a_{22} & a_{23}\\ 
a_{32} & a_{33}
\end{bmatrix}
$$

**代数余子式**：得到余子式行列式后，乘上$(-1)^{i+j}$就是代数余子式，如下：
$$
C_{11}=(-1)^{1+1}\begin{bmatrix}
a_{22} & a_{23}\\ 
a_{32} & a_{33}
\end{bmatrix}
$$


例题：计算如下行列式（按列展开）


$$
A=\begin{bmatrix}
3 & -7 & 8 & 9 & -6\\ 
0 & 2 & -5 & 7 & 3\\ 
0 & 0 & 1 & 5 & 0\\ 
0 & 0 & 2 & 4 & -1\\ 
0 & 0 & 0 & -2 & 0
\end{bmatrix}
$$


按第一列展开有：（选择具有0多的行，或者列展开，这里第一列0最多）


$$
detA=3 (-1)^{1+1}\begin{bmatrix}
2 & -5 & 7 & 3\\ 
0 & 1 & 5 & 0\\ 
0 & 2 & 4 & -1\\ 
0 & 0 & -2 & 0
\end{bmatrix} - 0C_{21} + 0C_{31} - 0C_{41}+0C_{51}
$$


把五阶行列式化为了四阶，再按第一列展开，化成三阶，最终计算出结果$detA=-12$

（正负号是通过$C_{ij}=(-1)^{i+j}detA_{ij}$ 的$(-1)^{i+j}$调节）



### 行列式的性质

行列式乘除一个实数：行列式的内部中找到一行或一列，乘除这个数，其他行列不变。相反的，也可以把行列式中的某行/列中的元素的共有因子提出来，示例如下乘在第2行：



$$
2\begin{vmatrix}
2 & 4\\ 
1 & 3
\end{vmatrix}
=
\begin{vmatrix}
2 & 4\\ 
2 & 6
\end{vmatrix}
$$























## 矩阵




### 矩阵的运算

矩阵与实数相乘：矩阵中每个元素都乘以这个数

矩阵相加/减：只有行列数都对应的两个矩阵才可相加/减，对应位置元素直接相加/减

矩阵相乘：矩阵相乘有顺序，一般$AB\neq BA$，

- 可以相乘的前提是：前一个矩阵的列数=后一个矩阵的行数
- 相乘的规则是：前一个矩阵的每行乘以后一个矩阵的列，对应元素相乘后求和，就是新元素



### 矩阵的转置

行列互换，例如：


$$
\begin{bmatrix}
1 &2  & 3\\ 
4 & 5 & 5
\end{bmatrix}^{T}=\begin{bmatrix}
1 &4  \\ 
2 & 5\\
3  &6
\end{bmatrix}
$$


转置的性质：

- $(A^{T})^{T} = A$
- ...





### 伴随矩阵

伴随矩阵用$A^{*}$ 表示，伴随矩阵是A阵的每一个元素的代数余子式组成的，并且ij互换。以一个三阶矩阵举例，三阶矩阵如下：
$$
A=\begin{bmatrix}
a_{11}& a_{12}& a_{13}\\
a_{21}& a_{22}& a_{23}\\
a_{31}& a_{32}& a_{33}
\end{bmatrix}
$$
$a_{11}$等元素代数余子式为$A_{11}$等，则$A^{*}$表示如下：
$$
A^{*}=\begin{bmatrix}
A_{11}& A_{21}& A_{31}\\
A_{12}& A_{22}& A_{32}\\
A_{13}& A_{23}& A_{33}
\end{bmatrix}
$$
$A_{ij} = (-1)^{i+j}M_{ij}$ ，$M_{ij}$是去掉第i行和第j列剩下的元素的行列式的值。例如：
$$
A_{11}=(-1^{1+1})\begin{vmatrix}
a_{22}& a_{23}\\
a_{32}& a_{33}\\
\end{vmatrix} （去掉第1行，第1列）
$$

$$
A_{12}=(-1^{1+2})\begin{vmatrix}
a_{21}& a_{23}\\
a_{31}& a_{33}\\
\end{vmatrix}（去掉第1行，第2列）
$$



### 矩阵的逆

A是n阶方阵，若存在一个n阶方阵C使：$AC=CA=I（单位阵）$，这时A是可逆的，A的逆为C，记：$A^{-1} = C$，或者称A与C互逆，也有$C^{-1}=A$

逆的性质：

- $(A^{-1})^{-1} = A$
- ...
- $detA\neq 0$等价于A可逆
- 0不是A的特征值时，A可逆
- A的行列式不等于0时，A可逆

**求逆矩阵**

**二阶矩阵求逆**

有二阶矩阵如下：


$$
A=\begin{bmatrix}
a & b\\ 
c & d
\end{bmatrix}
$$


若$detA\neq 0$，则A可逆，如下：


$$
A^{-1} = \frac{1}{detA}\begin{bmatrix}
d & -b\\ 
-c & a
\end{bmatrix}
$$

**高阶矩阵求逆**

求矩阵A的逆，把矩阵A扩展成$[A\quad I]$（I为单位矩阵），再做行变换，知道变成$[I\quad B]$，此时A的逆为B。若不能换成此形，则矩阵A就是不可逆的



高阶矩阵求逆还可以用**伴随矩阵**比行列式，如下：
$$
A^{-1} = \frac{A^{*}}{|A|}
$$




**主对角矩阵的逆矩阵**

$$
\begin{bmatrix}
a & 0\\ 
0 & b
\end{bmatrix}^{-1}=\begin{bmatrix}
\frac{1}{a} & 0\\ 
0 & \frac{1}{b}
\end{bmatrix}
$$



$$
\begin{bmatrix}
a & 0 &0\\ 
0 & b& 0\\
0 & 0 &c
\end{bmatrix}^{-1}=\begin{bmatrix}
\frac{1}{a} & 0 &0\\ 
0 & \frac{1}{b}& 0\\
0 & 0 &\frac{1}{c}
\end{bmatrix}
$$




### 子空间

子空间：$R^{n}$ 中的一个子空间是$R^{n}$ 中的集合$H$，具有以下三个性质：

- 零向量属于H
- 对H中任意的向量u和v，向量u+v属于H
- 对H中任意向量u和数c，向量cu属于H

零子空间：仅含零向量的集合，成为零子空间

列空间：矩阵A的列空间是A的各列的线性组合的集合，记作$Col A$

零空间：矩阵A的零空间是齐次方程$Ax=0$的所有解的集合，记为$NulA$



基：$R^{n}$中子空间H的一组基是H中一个线性无关集，他生成H

维数：非零子空间H的维数，用$dim H$表示，是H的任意一个基的向量个数。零子空间的维数定义为零。





### 矩阵的秩

矩阵的秩：是指矩阵A的列空间维数。用$rank A$ 表示。矩阵的秩与方程的解的性质有关

满秩：矩阵的秩等于列数

秩定理：矩阵A有n列，则$rank A+dim Nul A=n$

秩与可逆矩阵定理：A是一个n阶矩阵，则下面每个命题都与A是可逆矩阵的命题等价

- $Col A = R^{n}$
- $dim Col A= n$
- $rank A = n$     （满秩）
- $dim Nul A = 0$  （齐次方程$Ax=0$无解）

#### 求矩阵的秩

把矩阵经过初等行变换，变为阶梯型矩阵，数阶梯的个数，几个阶梯，秩就是几

**例1方阵**

在线性方程组唯一解的例子中，增广矩阵最后化简如下：


$$
\begin{bmatrix}
1 & 0 & 1 &1\\ 
0 & 1 & 1 &-1\\ 
0 & 0 & 3 &3
\end{bmatrix}
$$

可以看出，阶梯数为3，秩为3，而系数阵A是3X3的，所以该矩阵满秩（系数矩阵满秩，则线性方程组的解唯一）





## 特征值与特征向量

**特征值与特征向量**：A为n阶方阵，x为非零向量，若存在数$\lambda$使$Ax=\lambda x$有非平凡解（非零解），则称$\lambda$为A的特征值，x称A的特征向量。

对于$Ax=\lambda x$，有$(A-\lambda I)x=0$，当且仅当有非平凡解时，$\lambda$是A的特征值

**特征方程**：是一个数量方程，在$(A-\lambda I)x=0$中，$det(A-\lambda I)=0$的方程即为特征方程

数$\lambda$是n阶方阵A的特征值的充要条件是$\lambda$是特征方程$det(A-\lambda I)=0$的根

特征值的重数：某个特征值的出线的次数（就是某个重根的重数）

















### 对角化

把某个矩阵A化为对角矩阵。如果某个方阵A相似于对角矩阵，即存在可逆矩阵P和对角矩阵D，有$A = PDP^{-1}$则称A可对角化

**对角化定理**：n阶方阵A可对角化的充分必要条件是A有n个线性无关的特征向量

例题：将下面矩阵对角化，即求可逆矩阵P和对角矩阵D，使$A = PDP^{-1}$


$$
A = \begin{bmatrix}
1 & 3 &3\\ 
-3 & -5& -3\\
3 & 3&1
\end{bmatrix}
$$




**第一步**：求出A的特征值。$det(A-\lambda I)=0$ 的解，$\lambda=1$和$\lambda=-2(2重根)$

**第二步**：求A的三个线性无关的特征向量。

- $\lambda=1$时，$Av_1=\lambda v_1$，有$(A-I)v_1=0$，基是$v_{1} = (1,-1,1)$
- $\lambda=-2$时，$Av_2=\lambda v_2$，有$(A-I)v_2=0$，基是$v_2 = (-1,1,0)$和$v_{3} = (-1,0,1)$

（列向量表示：$[-1,0,1]^T$或$(-1,0,1)$）

且可以验证${v_{1},v_{2},v_{3}}$是线性无关的

**第三步**：用第二步得到的向量构造矩阵P，向量的次序不重要，这里使用第二步选择的次序，P如下：



$$
P = \begin{bmatrix}
v_{1} & v_{2} & v_{3}
\end{bmatrix}=\begin{bmatrix}
1 & -1 & -1\\ 
-1 & 1 & 0\\ 
1 & 0 & 1
\end{bmatrix}
$$



**第四步**：用对应的特征值构造矩阵D。构造D时，特征值的次序必须和矩阵P的列选择的特征向量的次序是一致的。D如下：



$$
D= \begin{bmatrix}
1 & 0 & 0\\ 
0 & -2 & 0\\ 
1 & 0 & -2
\end{bmatrix}
$$



验证P和D是否正确，为了避免计算$P^{-1}$可简单验证$AP=PD$，这等价于当P可逆时，$A = PDP^{-1}$（前提是必须确认P可逆）

```note
注意：
1. 每一个单根（非重根）都有一个唯一的特征向量，且和其他特征向量线性无关
2. 对于重根，特征向量的个数应该等于改根的重数，否则必然不可对角化（个数就会小于重数）
3. 对于重根，以为而重根为例，该重根有二个特征向量
```



### 线性变换





## 正交性

向量的长度：向量v的长度（范数）是非负数$\vert\vert v \vert\vert$，定义为$\vert\vert v \vert\vert = \sqrt{v\cdot v} = \sqrt{v_{1}^{2}+v_{2}^{2}}+...+v_{n}^{2}$，且$\vert\vert v \vert\vert^{2} = v\cdot v $，即欧式空间距离

向量的距离：向量u和v之间的距离记作$dist(u,v)$表示向量$u-v$的长度，即：$dist(u,v) = \vert\vert u-v \vert\vert $

正交向量：如果$u\cdot v = 0$，就说u和v是（相互）正交的

- 毕达哥拉斯（勾股）定理：两个向量u和v正交的充分必要条件是$\vert\vert u+v \vert\vert^{2} = \vert\vert v \vert\vert^{2}+\vert\vert u \vert\vert^{2}$

正交补：向量z和子空间W中的任意向量都正交，则称z正交于W，与子空间W正交的向量Z的全体组成的集合成为W的正交补，记作$W^{⊥}$（读作W正交补）





## 对称矩阵和二次型

对称矩阵：满足$A^{T} = A$的方阵，主对角线元可以是任意的

二次型：是一个函数，在向量x处的值可由表达式$Q(x) = x^T A x$计算，其中A是n阶对称方阵，矩阵A称为关于二次型的矩阵








## 其他

### 线性的概念

线性，满足叠加性和均匀性（齐次性）。假设f(x)是线性函数，那么满足如下：

- 迭加性：$f(x1)+f(x2) = f(x1+x2)$，
- 均匀性：$f(Ax1) = Af(x1)$（也叫比例性、倍增性）

$f(x) = x$满足上述两个特性，所以是线性的。但是$f(x) = x + 1$不满上述两个特性，所以不是线性的。

```tip
**注意：**{:.h3}

不是所有的直线都是线性的
```



### 奇异阵和非奇异阵

- 奇异矩阵：矩阵不是满秩的，不可逆
- 非奇异阵：矩阵是满秩的，可逆











